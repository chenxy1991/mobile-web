<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>ITSM服务管理系统</title>
  <meta http-equiv=X-UA-Compatible content="IE=edge">
  <meta name=format-detection content="telephone=no">
  <meta name=format-detection content="email=no">
  <meta name=apple-mobile-web-app-capable content=yes>
  <meta name=apple-mobile-web-app-status-bar-style content=black>
  <!-- UC强制全屏 -->
  <meta name=full-screen content=yes>
  <!-- UC应用模式 -->
  <meta name=browsermode content=application>
  <meta name=x5-orientation content=portrait>
  <!-- QQ强制全屏 -->
  <meta name=x5-fullscreen content=true>
  <!-- QQ应用模式 -->
  <meta name=x5-page-mode content=app>
  <!-- <span style="font-family: Arial, Helvetica, sans-serif;">屏幕自适应 高度</span> -->
  <!--清除缓存-->
  <meta http-equiv="Cache-Control" content="no-cache" />
  <meta http-equiv="Cache" content="no-cache">
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover">
  <!-- <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"> -->
  <!-- <link rel="icon" href="static/favicon.ico" type="image/x-icon" /> -->
  <!-- <link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon" /> -->
  <!-- font-awesome的相对路径 -->
  <link rel="stylesheet" href="./static/css/font-awesome.min.css">
  <!--  <link rel="stylesheet" href="static/css/mui.min.css"> -->
  <!-- <script src="static/js/mui.min.js"></script> -->
  <script>
    (function (doc, win, undefined) {
      var docEl = doc.documentElement,
        resizeEvt = 'orientationchange' in win ? 'orientationchange' : 'resize',
        recalc = function () {
          var clientWidth = docEl.clientWidth;
          if (clientWidth === undefined) return;
          if (clientWidth >= 640) {
            docEl.style.fontSize = '100px';
          } else {
            docEl.style.fontSize = 100 * (clientWidth / 640) + 'px';
          }

        };
      if (doc.addEventListener === undefined) return;
      win.addEventListener(resizeEvt, recalc, false);
      doc.addEventListener('DOMContentLoaded', recalc, false)
    })(document, window);

    // px转化成rem
   /*  (function (doc, win) {
      var docEl = doc.documentElement,
        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
        recalc = function () {
          var clientWidth = docEl.clientWidth;
          if (!clientWidth) return;
          if (clientWidth >= 750) {
            docEl.style.fontSize = '20px';
          } else {
            docEl.style.fontSize = 20 * (clientWidth / 375) + 'px';
          }
        };

      if (!doc.addEventListener) return;
      win.addEventListener(resizeEvt, recalc, false);
      doc.addEventListener('DOMContentLoaded', recalc, false);
    })(document, window); */

  </script>
</head>


  <!--  <div id="loading" style="position:absolute; top: 200px; left: 50%; transform: translate(-50%, -50%);">
            <img id="loadingImg" src="../static/loading.svg" alt="loading" style="width:150%;">
    </div> -->
  <div id="app">
  </div>
    <script src="https://cdn.bootcss.com/vue/2.5.21/vue.min.js"></script>
    <script src="https://cdn.bootcss.com/vue-router/3.0.2/vue-router.min.js"></script>
    <script src="https://cdn.bootcss.com/vuex/3.0.1/vuex.min.js"></script>
    <script src="https://cdn.bootcss.com/axios/0.19.0-beta.1/axios.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/vue-i18n/8.4.0/vue-i18n.js"></script>
    <script src="https://cdn.bootcss.com/vue-i18n/8.4.0/vue-i18n.min.js"></script>
    <!-- <script src="https://cdn.bootcss.com/mui/3.7.1/js/mui.min.js"></script> -->
  <script type="text/javascript">
    window.onload = function () { //在页面整体加载完毕时
      var wH = window.innerHeight > 0 ? window.innerHeight : document.documentElement.clientHeight;
      console.log(">>>" + wH);
      var wW = window.innerWidth > 0 ? window.innerWidth : document.documentElement.innerWidth;
      console.log(">>>wW" + wW);
      //document.body.style.width = wW + 'px'; //把获取到的高度直接赋值给body
      //document.body.style.height = wH + 'px'; //把获取到的高度直接赋值给body
}

  </script>

  <!-- <script type="text/javascript">
    window.onunload = function () {
      var scrollPos;
      if (typeof window.pageYOffset !== 'undefined') {
        scrollPos = window.pageYOffset;
      } else if (typeof document.compatMode !== 'undefined' && document.compatMode !== 'BackCompat') {
        scrollPos = document.documentElement.scrollTop;
      } else if (typeof document.body !== 'undefined') {
        scrollPos = document.body.scrollTop;
      }
      document.cookie = "scrollTop=" + scrollPos; //存储滚动条位置到cookies中
    };

    window.onload = function () {
      if (document.cookie.match(/scrollTop=([^;]+)(;|$)/) != null) {
        var arr = document.cookie.match(/scrollTop=([^;]+)(;|$)/); //cookies中不为空，则读取滚动条位置
        document.documentElement.scrollTop = parseInt(arr[1]);
        document.body.scrollTop = parseInt(arr[1]);
      }
    }
  </script> -->
<script>
  /* mui.init({
    keyEventBind: {
      backbutton: true //关闭back按键监听
    }
  });
  // //首页返回键处理
  // //处理逻辑：1秒内，连续两次按返回键，则退出应用；
  var first = null;
  mui.back = function () {
    //首次按键，提示‘再按一次退出应用’
    if (!first) {
      if (location.href.indexOf('/main') != -1) {
        first = new Date().getTime(); //记录第一次按下回退键的时间
        mui.toast('再按一次退出应用'); //给出提示
        //       history.go(-1)//回退到上一页面
        setTimeout(function () { //1s中后清除
          first = null;
        }, 1000);
      } else if (location.href.indexOf('/login') != -1) { //如果是登陆页面
        plus.runtime.quit(); //那么就退出app
      } else {
        history.go(-1) //回退到上一页面
      }
    } else {
      if (new Date().getTime() - first < 1000) { //如果两次按下的时间小于1s，
      let allKeys=self.storejs.keys();
      console.log(allKeys, 'allKeys==')
      allKeys.forEach(function(key, val) {
      console.log(key, '==', val)
      if(key==="userName"||key==="userPass"){
      console.log(key, '==1111111111', val)
      }else{
      self.storejs.remove(key)
      }
      })
        plus.runtime.quit(); //那么就退出app
      }
    }
  }; */
</script>
<script type="text/javascript">
  var wgtVer = null;
  function plusReady() {
    // Android处理返回键
    // 获取本地应用资源版本号
    plus.runtime.getProperty(plus.runtime.appid, function (inf) {
      wgtVer = inf.version;
      console.log("当前应用版本：" + wgtVer);
    });
  }
  if (window.plus) {
    plusReady();
  } else {
    document.addEventListener('plusready', plusReady, false);
  }
  // 检测更新
  var checkUrl = "http://demo.dcloud.net.cn/test/update/check.php";
  function checkUpdate() {
    plus.nativeUI.showWaiting("检测更新...");
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function () {
      switch (xhr.readyState) {
        case 4:
          plus.nativeUI.closeWaiting();
          if (xhr.status == 200) {
            console.log("检测更新成功：" + xhr.responseText);
            var newVer = xhr.responseText;
            if (wgtVer && newVer && (wgtVer != newVer)) {
              downWgt();	// 下载升级包
            } else {
              plus.nativeUI.alert("无新版本可更新！");
            }
          } else {
            console.log("检测更新失败！");
            plus.nativeUI.alert("检测更新失败！");
          }
          break;
        default:
          break;
      }
    }
    xhr.open('GET', checkUrl);
    xhr.send();
  }
  // 下载wgt文件
  var wgtUrl = "http://demo.dcloud.net.cn/test/update/H5EF3C469.wgt";
  function downWgt() {
    plus.nativeUI.showWaiting("下载wgt文件...");
    plus.downloader.createDownload(wgtUrl, { filename: "_doc/update/" }, function (d, status) {
      if (status == 200) {
        console.log("下载wgt成功：" + d.filename);
        installWgt(d.filename);	// 安装wgt包
      } else {
        console.log("下载wgt失败！");
        plus.nativeUI.alert("下载wgt失败！");
      }
      plus.nativeUI.closeWaiting();
    }).start();
  }
  // 更新应用资源
  function installWgt(path) {
    plus.nativeUI.showWaiting("安装wgt文件...");
    plus.runtime.install(path, {}, function () {
      plus.nativeUI.closeWaiting();
      console.log("安装wgt文件成功！");
      plus.nativeUI.alert("应用资源更新完成！", function () {
        plus.runtime.restart();
      });
    }, function (e) {
      plus.nativeUI.closeWaiting();
      console.log("安装wgt文件失败[" + e.code + "]：" + e.message);
      plus.nativeUI.alert("安装wgt文件失败[" + e.code + "]：" + e.message);
    });
  }
</script>
<script src="./static/js/vconsole.min.js"></script>
<body>
 <!--  Hello HBuilder for test update.<br />
  <br />
  version 1.0
  <br /><br /><br />
  <button onclick="checkUpdate()">Check Update</button> -->
  </body>
</html>
